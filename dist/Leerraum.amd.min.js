define("Leerraum",["exports"],function(t){"use strict";function p(e,n){return function(t){return 0==t?e:n(t-1)}}function c(e,n){return function(t){return n(t+e)}}function F(n){return function(e){return function(t){return n(e(t))}}}function z(t,e){return!(t.x+t.width<e.x||t.y+t.height<e.y||e.x+e.width<t.x||e.y+e.height<t.y)}var d=require("./linebreak").linebreak();function M(s,g,t,n){var y=[];return t.forEach(function(h,r,l){var t=h.text.split(/\s/),a=s(h.fontFamily,h.fontSize," "),e={width:n&&n.space.width||3,stretch:n&&n.space.stretch||6,shrink:n&&n.space.shrink||9},o=s(h.fontFamily,h.fontSize,"-"),u=a*e.width/e.stretch,f=a*e.width/e.shrink;t.forEach(function(t,e,n){var i=h.hyphenate?g.hyphenate(t):[t];1<i.length&&4<t.length?i.forEach(function(t,e,n){y.push({style:h,value:d.box(s(h.fontFamily,h.fontSize,t),t)}),e!==n.length-1&&y.push({style:h,value:d.penalty(o,100,1)})}):y.push({style:h,value:d.box(s(h.fontFamily,h.fontSize,t),t)}),r===l.length-1&&e===n.length-1?(y.push({style:h,value:d.glue(0,d.infinity,0)}),y.push({style:h,value:d.penalty(0,-d.infinity,1)})):e!==n.length-1&&y.push({style:h,value:d.glue(a,u,f)})})}),y}function C(u,f,t,e){var s=[];return t.forEach(function(h,r,l){var t=h.text.split(/\s/),a=u(h.fontFamily,h.fontSize," "),o=(e&&e.space.width,e&&e.space.stretch,e&&e.space.shrink,u(h.fontFamily,h.fontSize,"-"));t.forEach(function(t,e,n){var i=h.hyphenate?f.hyphenate(t):[t];1<i.length&&4<t.length?i.forEach(function(t,e,n){s.push({style:h,value:d.box(u(h.fontFamily,h.fontSize,t),t)}),e!==n.length-1&&s.push({style:h,value:d.penalty(o,100,1)})}):s.push({style:h,value:d.box(u(h.fontFamily,h.fontSize,t),t)}),r===l.length-1&&e===n.length-1?(s.push({style:h,value:d.glue(0,d.infinity,0)}),s.push({style:h,value:d.penalty(0,-d.infinity,1)})):e!==n.length-1&&(s.push({style:h,value:d.glue(0,12,0)}),s.push({style:h,value:d.penalty(0,0,0)}),s.push({style:h,value:d.glue(a,-12,0)}))})}),s}function k(u,f,t,e){var s=[];return 0<t.length&&(s.push({style:t[0],value:d.box(0,"")}),s.push({style:t[0],value:d.glue(0,12,0)})),t.forEach(function(h,r,l){var t=h.text.split(/\s/),a=u(h.fontFamily,h.fontSize," "),o=(e&&e.space.width,e&&e.space.stretch,e&&e.space.shrink,u(h.fontFamily,h.fontSize,"-"));t.forEach(function(t,e,n){var i=f.hyphenate(t);1<i.length&&4<t.length?i.forEach(function(t,e,n){s.push({style:h,value:d.box(u(h.fontFamily,h.fontSize,t),t)}),e!==n.length-1&&s.push({style:h,value:d.penalty(o,100,1)})}):s.push({style:h,value:d.box(u(h.fontFamily,h.fontSize,t),t)}),r===l.length-1&&e===n.length-1?(s.push({style:h,value:d.glue(0,12,0)}),s.push({style:h,value:d.penalty(0,-d.infinity,0)})):e!==n.length-1&&(s.push({style:h,value:d.glue(0,12,0)}),s.push({style:h,value:d.penalty(0,0,0)}),s.push({style:h,value:d.glue(a,-24,0)}),s.push({style:h,value:d.box(0,"")}),s.push({style:h,value:d.penalty(0,d.infinity,0)}),s.push({style:h,value:d.glue(0,12,0)}))})}),s}var S=require("./typeset/linebreak").linebreak();function u(E){return function(t,e){for(var n=[],i=[],h=[],r=0,l=E;r<l.length;r++){var a=l[r],o=a[0],u=(0,a[1])(t,F(o)(e)),f=u[0],s=u[1];i=i.concat(f),h=h.concat(s)}for(var g={},y=0,d=i;y<d.length;y++)for(var p=d[y],c=0,v=void 0,w=!1;v=e(c);){if(z(p,v))void 0===g[c]&&(g[c]=[]),g[c].push(p),w=!0;else if(w)break;c++}for(var x,m,A,b,M=0,C=Object.keys(g).sort();M<C.length;M++){var k=g[C[M]],S=k[0];for(c=1;c<k.length;c++)x=S,m=k[c],void 0,A=Math.min(x.x,m.x),b=Math.min(x.y,m.y),S={x:A,y:b,width:Math.max(x.x+x.width,m.x+m.width)-A,height:Math.max(x.y+x.height,m.y+m.height)-b};n.push(S)}return[n,h]}}function n(d){return function(t,e){for(var n=[],i=e,h=[],r=0,l=d;r<l.length;r++){var a=(0,l[r])(t,i),o=a[0],u=a[1];if(0<o.length){for(var f=null,s=o[o.length-1],g=0;null!==(f=i(g))&&!z(f,s);)g++;if(null!=f){var y={x:f.x,y:s.y+s.height,width:f.width,height:f.y+f.height-(s.y+s.height)};i=0<y.height?p(y,c(g+1,i)):c(g+1,i)}}h=h.concat(o),n=n.concat(u)}return[h,n]}}function e(b){return function(s,r){function l(t,e){for(var n=0,i=0,h=null;null!==(h=r(i));){if(e-n<h.height)return[h,i];n+=Math.floor(h.height/t)*t,i++}return[null,i]}var g,y,d,t,p=[],c=0,v=null,e=[];switch(b.align){case"left":default:t=C;break;case"center":t=k;break;case"justify":t=M}for(var n,i,h=t(s.measure,b.hypher,b.spans,null),a=S(h.map(function(t){return t.value}),(n=function(t){var e=l(b.leading,c+(t+1)*b.leading),n=e[0],i=(e[1],(b.leftIndentation?b.leftIndentation(t):0)+(b.rightIndentation?b.rightIndentation(t):0));return null!==n?n.width-i:null},i={},function(t){return void 0!==i[t]||(i[t]=n(t)),i[t]}),{tolerance:b.tolerance||10}),o=[],u=0,f=1;f<a.length;f+=1){for(var w=a[f].position,x=a[f].ratio,m=u;m<h.length;m+=1)if("box"===h[m].value.type||"penalty"===h[m].value.type&&h[m].value.penalty===-S.infinity){u=m;break}o.push({ratio:x,nodes:h.slice(u,w+1),position:w}),u=w}g=0,o.forEach(function(a,t){var e,n,i,h,o=0,u=0,f=b.leftIndentation?b.leftIndentation(t):0;g+=b.leading,c+=b.leading,e=l(b.leading,c),y=e[0],d=e[1],null===v||(i=v,h=.001,(n=y).x>=i.x-h&&n.x<=i.x+h&&n.y>=i.y-h&&n.y<=i.y+h&&n.width>=i.width-h&&n.width<=i.width+h&&n.height>=i.height-h&&n.height<=i.height+h)||(g=b.leading),v=y,a.nodes.forEach(function(t,e,n){var i=-s.fontMetrics(t.style.fontFamily).ascender/1e3*t.style.fontSize,h=y.x+o,r=y.y+g;if("box"===t.value.type){if(0===o){var l=t.value.value[0]?s.glyphMetrics(t.style.fontFamily,t.value.value[0]).leftBearing:0;u=-l/1e3*t.style.fontSize}p.push({type:"text",x:h+u+f,y:r+i,span:t.style,text:t.value.value}),o+=t.value.width}else"glue"===t.value.type?o+=t.value.width+a.ratio*(a.ratio<0?t.value.shrink:t.value.stretch):"penalty"===t.value.type&&100===t.value.penalty&&e===n.length-1&&p.push({type:"text",x:h+u+f,y:r+i,span:t.style,text:"-"})})});for(var A=0;A<d;A++)e.push(r(A));return null!=y&&e.push({x:y.x,y:y.y,width:y.width,height:Math.min(y.height,g+(b.paragraphLeading||0))}),[e,p]}}function h(t,e){for(var n=[],i=0,h=0,r=e;h<r.length;h++){var l=r[h],a=l[0],o=l[1];n.push([[i,a],o]),i+=a+t}return u(n.map(function(t){var e,n,i,h=t[0],r=t[1];return[(e=h,n=e[0],i=e[1],function(t){return{x:t.x+n,y:t.y,width:i,height:t.height}}),r]}))}function f(i){return{measure:function(t,e,n){return i.font(t)._font.widthOfString(n,e)},fontMetrics:function(t){return{ascender:i.font(t)._font.ascender}},glyphMetrics:function(t,e){return{leftBearing:i.font(t)._font.font.layout(e).glyphs[0]._metrics.leftBearing}}}}function b(t,e){void 0!==e.lineWidth&&t.lineWidth(e.lineWidth),void 0!==e.strokeColor&&t.strokeColor(e.strokeColor),void 0!==e.fillColor&&t.fillColor(e.fillColor),void 0!==e.strokeOpacity&&t.strokeOpacity(e.fillColor),void 0!==e.fillOpacity&&t.fillOpacity(e.fillColor),void 0!==e.lineJoin&&t.lineJoin(e.lineJoin),void 0!==e.lineCap&&t.lineCap(e.lineCap)}function s(t,e,n,i){for(var h=0,r=0,l=n;r<l.length;r++)for(var a=0,o=l[r];a<o.length;a++){var u=o[a],f=Math.floor(u.y/e.height);h=Math.max(h,f)}var s=Array(h+1).fill([]);if(i)for(f=0;f<=h;f++)for(var g=0,y=i(f);g<y.length;g++)for(var d=0,p=y[g];d<p.length;d++){u=p[d];s[f].push(u)}for(var c=0,v=n;c<v.length;c++)for(var w=0,x=v[c];w<x.length;w++){u=x[w];s[f=Math.floor(u.y/e.height)].push(u)}for(f=0;f<=h;f++){0!=f&&t.addPage();for(var m=0,A=s[f];m<A.length;m++){u=A[m];switch(t.save(),u.type){case"text":t.save(),b(t,u.span.style||{}),t.font(u.span.fontFamily).fontSize(u.span.fontSize)._fragment(u.text,u.x,u.y-f*e.height,u.span.options||{}),t.restore();break;case"polygon":t.save(),b(t,u.style||{}),u.style.fillColor&&u.style.strokeColor?(t.polygon.apply(t,u.points.map(function(t){return[t.x,t.y]})),t.fillAndStroke()):u.style.fillColor?(t.polygon.apply(t,u.points.map(function(t){return[t.x,t.y]})),t.fill()):u.style.strokeColor&&(t.polygon.apply(t,u.points.map(function(t){return[t.x,t.y]})),t.stroke()),t.restore()}}}}t.columnsWithMargins=function(e,n,i,h,r,l){return function(t){return t%2==0?{tag:"new_page",x:l,y:Math.floor(t/2)*e.height+i,width:e.width/2-n/2-l,height:e.height-(i+r)}:{x:n/2+e.width/2,y:Math.floor(t/2)*e.height+i,width:e.width/2-n/2-h,height:e.height-(i+r)}}},t.combine=u,t.formats={"4A0":{width:4767.87,height:6740.79},"2A0":{width:3370.39,height:4767.87},A0:{width:2383.94,height:3370.39},A1:{width:1683.78,height:2383.94},A2:{width:1190.55,height:1683.78},A3:{width:841.89,height:1190.55},A4:{width:595.28,height:841.89},A5:{width:419.53,height:595.28},A6:{width:297.64,height:419.53},A7:{width:209.76,height:297.64},A8:{width:147.4,height:209.76},A9:{width:104.88,height:147.4},A10:{width:73.7,height:104.88},B0:{width:2834.65,height:4008.19},B1:{width:2004.09,height:2834.65},B2:{width:1417.32,height:2004.09},B3:{width:1000.63,height:1417.32},B4:{width:708.66,height:1000.63},B5:{width:498.9,height:708.66},B6:{width:354.33,height:498.9},B7:{width:249.45,height:354.33},B8:{width:175.75,height:249.45},B9:{width:124.72,height:175.75},B10:{width:87.87,height:124.72},C0:{width:2599.37,height:3676.54},C1:{width:1836.85,height:2599.37},C2:{width:1298.27,height:1836.85},C3:{width:918.43,height:1298.27},C4:{width:649.13,height:918.43},C5:{width:459.21,height:649.13},C6:{width:323.15,height:459.21},C7:{width:229.61,height:323.15},C8:{width:161.57,height:229.61},C9:{width:113.39,height:161.57},C10:{width:79.37,height:113.39},RA0:{width:2437.8,height:3458.27},RA1:{width:1729.13,height:2437.8},RA2:{width:1218.9,height:1729.13},RA3:{width:864.57,height:1218.9},RA4:{width:609.45,height:864.57},SRA0:{width:2551.18,height:3628.35},SRA1:{width:1814.17,height:2551.18},SRA2:{width:1275.59,height:1814.17},SRA3:{width:907.09,height:1275.59},SRA4:{width:637.8,height:907.09},EXECUTIVE:{width:521.86,height:756},FOLIO:{width:612,height:936},LEGAL:{width:612,height:1008},LETTER:{width:612,height:792},TABLOID:{width:792,height:1224}},t.idRenderer=function(t,e){return[[],[]]},t.jsPdfDocMeasures=function(h){return{measure:function(t,e,n){var i=String(t).split("\t");return h.setFont(i[0],i[1]).getStringUnitWidth(n)*e},fontMetrics:function(t){return{ascender:0}},glyphMetrics:function(t,e){return{leftBearing:0}}}},t.landscape=function(t){return{width:t.height,height:t.width}},t.pageBreak=function(t,e){for(var n=0,i=[];"new_page"!==e(n).tag;)i.push(e(n)),n++;return[i,[]]},t.pdfKitDocMeasures=f,t.renderColumns=h,t.renderParagraph=e,t.renderPolygon=function(h,r){return function(t,e){var n=e(0),i=function(t){for(var e=Number.MIN_VALUE,n=Number.MIN_VALUE,i=Number.MAX_VALUE,h=Number.MAX_VALUE,r=0,l=t;r<l.length;r++){var a=l[r];e=Math.max(e,a.x),i=Math.min(i,a.x),n=Math.max(n,a.y),h=Math.min(h,a.y)}return{x:i,y:i,width:e-i,height:n-h}}(h);return[[{x:n.x+i.x,y:n.y+i.x,width:i.width,height:i.height}],[{type:"polygon",x:n.x,y:n.y,points:h.map(function(t){return{x:t.x+n.x,y:t.y+n.y}}),style:r}]]}},t.renderTable=function(e,i,t){return n(t.map(function(t){return h(e,(n=t,i.map(function(t,e){return[t,n[e]]})));var n}))},t.renderText=function(t){return n(t.map(function(t){return e(t)}))},t.renderToPDF=function(t,e,n,i,h,r){var l=new h({layout:"portrait",size:[e.width,e.height]}),a=f(l),o=r.createWriteStream(t);l.pipe(o);var u=void 0;return i&&(u=function(t){return i(t).map(function(t){return t.renderer(a,t.bboxes)[1]})}),s(l,e,n.map(function(t){return t.renderer(a,t.bboxes)[1]}),u),l.end(),o},t.renderToPages=s,t.vertically=n,t.withMargins=function(e,n,i,h,r){return function(t){return{tag:"new_page",x:r,y:t*e.height+n,width:e.width-(r+i),height:e.height-(n+h)}}},Object.defineProperty(t,"__esModule",{value:!0})});
